---
title: 'Scyland3D: Processing 3D landmarks'
tags:
  - 3D geometric morphometrics
  - shape analysis
  - Landmark
  - Python
authors:
  - name: Fidji Berio
    orcid: 0000-0003-0810-9783
    affiliation: "1, 2"
  - name: Yann Bayle
    orcid: 0000-0002-5143-2335
    affiliation: "3"
affiliations:
 - name: ISEM, UMR 5554, CNRS-IRD-UM, 34095 Montpellier, France
   index: 1
 - name: IGFL, UMR 5242, CNRS-ENS de Lyon, 69007 Lyon, France
   index: 2
 - name: LaBRI, UMR 5800, CNRS, 33400 Talence, France
   index: 3
date: 03 January 2019
bibliography: paper.bib
---

# Abstract

``Scyland3D`` is a Python tool for converting 3D raw landmark and semilandmark coordinates to a usable format for geometric morphometric analyses.
Processing schemes to mirror and reorder these points are provided to address further symmetry issues.
This is useful when working on left-right differences in a given species. 
This tool is designed to pre-process the raw extracted landmarks and to generate a database-like CSV file for statistical analyses.
The main targeted audience are biologist looking for an easy and quick parser for raw landmarks.

# Background

Living organisms display a high diversity of shapes and sizes that are used to characterize ontogenetic stages and phylogenies [@Jones2015; @Guinot2018; @Musa2018].
Shape similarities are used as phylogenetic signal ---mostly in extinct species--- and, when combined with ecological data, allow describing trophic habits of species [@Randau2016].

Traditional 2D morphometrics, _ie in situ_ or picture measurements of structural element dimensions, have long been favoured to quantitatively compare extant and extinct shapes of organisms [@Adams2013].
However, part of these measurements did not reflect the geometry of the structures and depended for example on their relative size.
Landmark-based geometric morphometrics in 2D allows separating a form into size and shape within a set of measures.
In this method, landmarks define comparable points within a set of objects and capture their geometry.
A Procrustes superimposition then rescales, rotates and translates these landmarks to virtually superimpose all object geometries [@Zelditch2004; @Adams2013]. 
Each measured variable, however, is partly independent of other ones on the same structure as all may have been quantified in different 2D views of the same object.
Then, merging morphometric datasets for global analyses may bring noise in the results.

Landmark-based geometric morphometrics in 3D emerged with recent imaging techniques among others X-ray microtomography [@Adams2013]. 
3D surfaces are created based on scanned organisms and landmarks can be set on all views of interest of a given specimen and belong to the same dataset, with the same reference space.   
Few free software solutions allow digitizing 3D landmarks and semilandmarks, and they do not offer complete tools for subsequent shape and size analyses.
Most morphometricians use R packages to perform size and shape analyses but input data must already be in package-specific formats that often highly differ from the output formats generated by landmark acquisition software products.
Moreover, the rise of intra- and interspecific asymmetry questions involves post-processing steps of morphometric datasets that are not managed by current R packages.

# ``Scyland3D`` details

``Scyland3D`` can be installed from pip https://pypi.org/project/Scyland3D or from the Github repository https://github.com/ybayle/Scyland3D.

We introduce ``Scyland3D`` to convert .pts files, exported by the Landmark software (v3.6), into .csv files.
``Scyland3D`` first removes duplicated coordinates because landmarks and semilandmarks might be mixed up in the Landmark software.
We then allow to mirror the landmark and semilandmark coordinates for a subset of 3D objects and to reorder these points.
This allows performing 3D geometric morphometric analyses between previously asymmetrical objects (Figure 1).

![Landmarked small-spotted catshark _Scyliorhinus canicula_ (A) upper tooth and (B) lower tooth. Only landmarks are drawn but semilandmarks can be set between them. Numbers indicate their relative order of setting. Surfaces were generated based on 3D X-ray microtomography scans.](figure1.png)

Manual landmarking might generate coordinate duplicates or missing landmarks and semilandmarks.
Before processing the data, ``Scyland3D`` checks their integrity because setting landmarks in 3D is an error-prone manual operation.
``Scyland3D`` thus checks and reports the:

- Consistency of folder and file names,
- Number of landmarks and semilandmarks across all structures,
- Precision of landmark and semilandmark coordinates export by the Landmark software.

Processing options can be specified in order to modify the dataset asymmetry.
In this case, landmark and semilandmark coordinates of elements characterized by a given feature can be sequentially mirrored and reordered.
Mirror processing involves the use of the Least Squares method and generates a regression plane through all the landmark and semilandmark coordinates of an object.
This plane is subsequently used as a symmetry plane and a projection of landmark and semilandmark coordinates is generated for each 3D object.
For the mirrored objects, a reorder of landmarks and semilandmarks can be done and the software needs a vector containing their new relative positions specified. 
Indeed, geometric morphometrics aim at comparing shape objects after a standardization process (Procrustes superimposition).
During the latter step, the space distance is minimized between equivalent landmarks.
This equivalence is given by their relative order of placement, e.g. a minimized distance is calculated between the first landmark placed in object 1 and the first landmark placed in object 2.
Such a process implies that landmarks must be placed in the exact same order in all comparable objects of the dataset.
Thus, mirrored objects have reverted bending compared to others and this must be compensated by reordering the mirrored landmarks.

``Scyland3D`` is currently used on larger datasets with different specimens to compare upper and lower tooth shapes at intraspecific scale and deciphering symmetry patterns.
We aim at characterizing tooth shape transformations across growth stages and emerging sexual dimorphism in _S. canicula_ and unravel ontogenetic and evolutionary processes.
We provide an example use-case with a subset of our dataset in our Github repository to help newcomers handle ``Scyland3D``.

# Acknowledgements

We acknowledge the contribution of SFR Biosciences (UMS3444/CNRS, US8/Inserm, ENS de Lyon, UCBL) facilities: AniRA-ImmOs and Mathilde Bouchet for her help with X-ray microtomography.

# References
